# 卒業論文構成案：YOLOv11を用いたバーベル挙上速度計測システム

分析したプロジェクト（`analyze_lift_latest.py`等）の内容に基づき、技術的・工学的観点から評価の高い卒論構成案を提案します。

## 1. 論文タイトル案
論文の方向性に合わせて適切なものを選択してください。

*   **案A（技術・実装重視）:**
    *   「YOLOv11を用いたスマートフォン向けリアルタイムVBTシステムの開発とモデルサイズによる性能評価」
    *   *Development of Real-time VBT System for Smartphones using YOLOv11 and Performance Evaluation by Model Size*
*   **案B（アルゴリズム・精度重視）:**
    *   「姿勢推定と物体検出の統合による高精度バーベル追跡手法の提案」
    *   *Proposal of High-Precision Barbell Tracking Method by Integrating Pose Estimation and Object Detection*
*   **案C（アプリケーション・実用性重視）:**
    *   「単眼カメラを用いたバーベル挙上速度計測システムの構築とトレーニング現場への適用可能性の検討」

---

## 2. 章立て構成案 (Table of Contents)

### 第1章 序論 (Introduction)
*   **1.1 研究背景**
    *   ウエイトトレーニングにおけるVBT (Velocity Based Training) の重要性と普及。
    *   従来の計測機器（リニアエンコーダ等）の問題点：高価、設置の手間、専用機材が必要。
    *   コンピュータビジョン(CV)を用いた既存アプリの課題：処理速度、背景ノイズ（他のプレートや人）、精度の不安定さ。
*   **1.2 研究目的**
    *   最新の物体検出モデル **YOLOv11** を用い、安価かつ手軽に高精度な計測ができるシステムの開発。
    *   特にモバイル環境（スマートフォン等）での動作を見据え、モデルサイズ（Nano〜XLarge）による**精度と推論速度のトレードオフ**を明らかにする。
    *   ジムの混雑環境下でも誤検知を防ぐ独自のフィルタリングアルゴリズムの実装と評価。

### 第2章 関連研究 (Related Work)
*   **2.1 VBTにおける計測技術**
    *   加速度センサ、リニアエンコーダ、映像解析の比較。
*   **2.2 物体検出と姿勢推定**
    *   YOLOシリーズの進化（v8からv11への改善点）。
    *   Pose Estimation（姿勢推定）のスポーツ解析への応用事例。

### 第3章 提案手法 (Proposed Method)
*   **3.1 システム概要**
    *   入力：単眼カメラ映像（スマートフォン撮影を想定）。
    *   出力：挙上速度、Rep数、挙上軌跡の可視化。
*   **3.2 使用モデル**
    *   **Barbell/Plate Detection**: カスタムデータセット(1.5万枚)で学習させたYOLOv11 (Class: `weight_clump`)。
    *   **Lifter Pose Estimation**: YOLOv11-pose (Pre-trained) を使用し、リフターの位置を特定。
*   **3.3 ハイブリッド・トラッキングアルゴリズム** (ここが技術的なオリジナリティ)
    *   **Lifter Context**: 姿勢推定によりリフターの「肩・腰」の中心を特定し、その近傍にあるプレートのみを追跡対象とする（他人のプレート誤検知を防止）。
    *   **Static Object Filtering**: 分散（Variance）を用いた静止物体除去フィルタの実装（ラックにかかっているプレート等の除外）。
    *   **Trajectory Smoothing**: 移動平均フィルタやSavitzky-Golayフィルタ、外れ値除去（Jump Threshold）によるノイズ低減処理。
    *   **Velocity Calculation**: フレーム間差分とFPSを用いた瞬時速度・平均速度の算出ロジック。

### 第4章 実験 (Experiments)
*   **4.1 実験設定**
    *   データセット：自作データセット（枚数、撮影環境、バリエーション）。
    *   評価指標：mAP (mean Average Precision)、FPS (Frames Per Second)。
    *   ハードウェア環境：GPUサーバ（学習用）、ローカルPC/エッジデバイス（推論テスト用）。
*   **4.2 実験1：モデルサイズ別の性能比較**
    *   YOLOv11の各モデル（Nano, Small, Medium, Large, XLarge）におけるmAPの比較。
    *   各モデルの推論速度（FPS）の比較。
    *   **仮説/検証**: Nanoモデルでも、限定されたタスク（プレート検出）であれば十分な精度が出るのではないか？
*   **4.3 実験2：追跡アルゴリズムの堅牢性評価**
    *   「単純な物体検出」vs「提案手法（姿勢推定+フィルタ統合）」の比較。
    *   背景に他のプレートがある動画や、カメラの手ブレがある動画での成功率比較。
    *   **仮説/検証**: Nanoモデルでも、限定されたタスク（プレート検出）であれば十分な精度が出るのではないか？
*   **4.3 実験2：追跡アルゴリズムの堅牢性評価**
    *   「単純な物体検出」vs「提案手法（姿勢推定+フィルタ統合）」の比較。
    *   背景に他のプレートがある動画や、カメラの手ブレがある動画での成功率比較。
*   **4.4 実験3：実測値との比較による精度検証（選択した手法）**
    *   **手法**: 実際の挙上距離をメジャー等で計測し、映像から算出した推定値と比較する。
    *   **手順**:
        1.  被験者のベンチプレスにおいて、バーのボトム（胸についた位置）からトップ（腕を伸ばしきった位置）までの**垂直距離**をメジャーで正確に計測する（例: 45.0cm）。
        2.  同試技をスマートフォンで撮影し、システムで解析する。
        3.  解析結果の変位量（ピクセル→cm変換後）と比較し、誤差率（Error Rate）を算出する。
        4.  $誤差率 (\%) = |実測値 - 推定値| / 実測値 \times 100$
    *   **意義**: 高価なモーションセンサがなくても、物理的な長さを基準（Ground Truth）とすることで、システムの幾何学的な正確さを定量的に評価できる。

### 第5章 考察 (Discussion)
*   **5.1 モデル選定の最適解**
    *   結果に基づき、スマートフォンアプリ化するなら「YOLOv11n (Nano)」が最適解である（例）、あるいは「精度重視ならM、速度重視ならN」などの使い分けの提案。
    *   1.5万枚というデータセット規模が、軽量モデルの精度向上にどう寄与したか。
*   **5.2 誤検知の分析**
    *   検出に失敗したケース（照明、極端な角度、高速動作時のブレ）の分析。
*   **5.3 実用化に向けた課題**
    *   リアルタイム処理の限界と、モバイルデバイスへのポーティング（CoreML/TFLite化）への展望。

### 第6章 結論 (Conclusion)
*   本研究の成果まとめ。
*   YOLOv11を用いたことで、従来手法より高いFPSで同等の精度を実現できた（等の結論）。

---

## 3. 具体的な執筆等のポイント（コードからの示唆）

プロジェクト内のコード（`analyze_lift_latest.py`等）からは、以下の点が**「工夫点」**として論文に盛り込めます：

1.  **「静止物体フィルタ (Static Filter)」**:
    *   コード内の `track_history` と `STATIC_VAR_THRESHOLD` を用いたロジックは、ジムという「動かないプレート（背景）」が大量にある環境特有の問題を解決する良い工夫です。これを「環境適応型フィルタリング」として強調しましょう。
2.  **「リフター中心点との連携 (Lifter Center Association)」**:
    *   `get_lifter_center` 関数でリフターの位置を割り出し、`weight_clumps` を距離順でソートしている点は、単なる物体検出を超えた「コンテキスト認識」です。これも立派な技術的貢献です。
3.  **データセットの規模**:
    *   「1.5万枚」の自作データセットは、卒論レベルでは非常に大きな強みです。どのように収集・アノテーション（半自動化スクリプト `unify_labels.py` 等の使用含む）したかも、実験の章で詳しく書くと評価が上がります。
